name: Multi Request Every 5 Minutes

on:
  schedule:
    - cron: '*/5 * * * *'  # Chạy mỗi 5 phút (UTC time)
  workflow_dispatch:  # Cho phép chạy thủ công từ GitHub UI

jobs:
  send-requests:
    runs-on: ubuntu-latest
    steps:
      - name: Send Multiple HTTP Requests
        run: |
          # Danh sách URL để gửi request (thay bằng URL thực tế)
          URLS=(
            "https://www.phimtv.net/vi"
            "https://funtv-ol7y.onrender.com/"
            "https://www.phimtv.net/vi/favorites"
          )
          
          # User-Agent giả lập thiết bị di động
          USER_AGENT="Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Mobile/15E148 Safari/604.1"
          
          # Lặp qua từng URL và gửi request
          for URL in "${URLS[@]}"; do
            TIMESTAMP=$(date -u '+%Y-%m-%d %H:%M:%S UTC')
            echo "[$TIMESTAMP] Sending request to $URL"
            RESPONSE=$(curl -X GET "$URL" \
              -H "User-Agent: $USER_AGENT" \
              -H "Accept: application/json" \
              --fail --silent --show-error --write-out "%{http_code}" 2>&1)
            if [ $? -eq 0 ]; then
              echo "[$TIMESTAMP] Success: HTTP $RESPONSE - $URL"
            else
              echo "[$TIMESTAMP] Failed: $RESPONSE - $URL"
            fi
          done